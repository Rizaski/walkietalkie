<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#10b981">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Walkie-Talkie</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
</head>

<body>
    <!-- SVG Icon Definitions -->
    <svg style="display: none;">
        <symbol id="icon-mic" viewBox="0 0 24 24">
            <path fill="currentColor" d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z" />
            <path fill="currentColor" d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z" />
        </symbol>
        <symbol id="icon-mic-off" viewBox="0 0 24 24">
            <path fill="currentColor" d="M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27 7.73 9H3v6h4c0 2.21 1.79 4 4 4s4-1.79 4-4v-1.73L19.73 21 21 19.73 4.27 3zM12 14c-1.66 0-3-1.34-3-3V9h.18L12 11.82V14z" />
        </symbol>
        <symbol id="icon-users" viewBox="0 0 24 24">
            <path fill="currentColor" d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" />
        </symbol>
        <symbol id="icon-channel" viewBox="0 0 24 24">
            <path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z" />
        </symbol>
        <symbol id="icon-settings" viewBox="0 0 24 24">
            <path fill="currentColor" d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94L14.4 2.81c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" />
        </symbol>
        <symbol id="icon-home" viewBox="0 0 24 24">
            <path fill="currentColor" d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
        </symbol>
        <symbol id="icon-chevron-right" viewBox="0 0 24 24">
            <path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" />
        </symbol>
        <symbol id="icon-chevron-left" viewBox="0 0 24 24">
            <path fill="currentColor" d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" />
        </symbol>
        <symbol id="icon-check" viewBox="0 0 24 24">
            <path fill="currentColor" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
        </symbol>
        <symbol id="icon-close" viewBox="0 0 24 24">
            <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
        </symbol>
        <symbol id="icon-wifi" viewBox="0 0 24 24">
            <path fill="currentColor" d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C6.93 2.93 1.07 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z" />
        </symbol>
        <symbol id="icon-wifi-off" viewBox="0 0 24 24">
            <path fill="currentColor" d="M24 8.98l-2.12 2.13C19.35 8.57 15.85 7 12 7c-1.5 0-2.93.3-4.24.82L5.38 6.13C7.21 5.29 9.55 5 12 5c6.97 0 13.03 4.97 15 9l-2.12 2.13L24 8.98zM2.06 1.51L.65 2.92 2.38 4.65C1.34 5.74.64 7.16.24 8.98l2.12 2.13c.5-1.5 1.39-2.83 2.6-3.89l1.87 1.87c-1.66 1.66-2.66 3.89-2.66 6.24l2 2c0-3.24 1.5-6.18 3.84-8.11l1.87 1.87C9.5 10.5 9 11.7 9 13l2 2c0-1.1.9-2 2-2l4.38 4.38-1.41 1.41L21.94 22.49l1.41-1.41L2.06 1.51zm7.5 7.5l1.87 1.87C10.5 11.5 10 12.7 10 13l2 2c0-.36.1-.7.27-1l-2.71-2.99z" />
        </symbol>
        <symbol id="icon-volume" viewBox="0 0 24 24">
            <path fill="currentColor" d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z" />
        </symbol>
        <symbol id="icon-volume-off" viewBox="0 0 24 24">
            <path fill="currentColor" d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z" />
        </symbol>
        <symbol id="icon-alert" viewBox="0 0 24 24">
            <path fill="currentColor" d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" />
        </symbol>
        <symbol id="icon-lock" viewBox="0 0 24 24">
            <path fill="currentColor" d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z" />
        </symbol>
        <symbol id="icon-unlock" viewBox="0 0 24 24">
            <path fill="currentColor" d="M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z" />
        </symbol>
        <symbol id="icon-waveform" viewBox="0 0 24 24">
            <path fill="currentColor" d="M1 9h2v6H1zm4-4h2v14H5zm4-4h2v22H9zm4 4h2v14h-2zm4-4h2v6h-2z" />
        </symbol>
    </svg>

    <!-- App Container -->
    <div id="app">
        <!-- Login Page -->
        <div id="login-page" class="page active">
            <div class="login-container">
                <div class="logo">
                    <svg class="icon-large">
                        <use href="#icon-mic"></use>
                    </svg>
                    <h1>Walkie-Talkie</h1>
                    <p>Real-time communication</p>
                </div>
                <form id="login-form" class="login-form">
                    <div class="input-group">
                        <label for="username-input">Username</label>
                        <input type="text" id="username-input" placeholder="Enter your name" required autocomplete="name">
                    </div>
                    <div class="input-group">
                        <label for="role-select">Role</label>
                        <select id="role-select">
                            <option value="user">User</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary btn-large">
                        <span>Connect</span>
                    </button>
                </form>
                <div id="connection-status" class="status-indicator">
                    <span class="status-dot"></span>
                    <span>Connecting...</span>
                </div>
            </div>
        </div>

        <!-- Channel List Page -->
        <div id="channels-page" class="page">
            <header class="app-header">
                <h1>Channels</h1>
                <button id="settings-btn" class="icon-btn" aria-label="Settings">
                    <svg class="icon">
                        <use href="#icon-settings"></use>
                    </svg>
                </button>
            </header>
            <main class="page-content">
                <div class="search-bar">
                    <input type="text" id="channel-search" placeholder="Search channels...">
                </div>
                <div id="channels-list" class="channels-list">
                    <!-- Channels will be populated here -->
                </div>
                <button id="create-channel-btn" class="fab" aria-label="Create Channel">
                    <svg class="icon">
                        <use href="#icon-channel"></use>
                    </svg>
                </button>
            </main>
            <nav class="bottom-nav">
                <button class="nav-item active">
                    <svg class="icon">
                        <use href="#icon-channel"></use>
                    </svg>
                    <span>Channels</span>
                </button>
                <button class="nav-item" id="nav-users">
                    <svg class="icon">
                        <use href="#icon-users"></use>
                    </svg>
                    <span>Users</span>
                </button>
            </nav>
        </div>

        <!-- Channel View Page -->
        <div id="channel-page" class="page">
            <header class="app-header">
                <button id="back-btn" class="icon-btn" aria-label="Back">
                    <svg class="icon" style="transform: rotate(180deg);">
                        <use href="#icon-chevron-right"></use>
                    </svg>
                </button>
                <div class="header-content">
                    <h1 id="channel-name">Channel</h1>
                    <p id="channel-status" class="subtitle">Connecting...</p>
                </div>
                <button id="channel-menu-btn" class="icon-btn" aria-label="Menu">
                    <svg class="icon">
                        <use href="#icon-settings"></use>
                    </svg>
                </button>
            </header>
            <main class="page-content channel-view">
                <div class="network-indicator" id="network-status">
                    <svg class="icon">
                        <use href="#icon-wifi"></use>
                    </svg>
                    <span>Connected</span>
                </div>
                <div class="roster-section">
                    <h3>
                        <svg class="icon">
                            <use href="#icon-users"></use>
                        </svg>
                        <span>Online Users</span>
                        <span id="user-count" class="badge">0</span>
                    </h3>
                    <div id="roster-list" class="roster-list">
                        <!-- Users will be populated here -->
                    </div>
                </div>
                <div class="activity-log">
                    <h3>Activity</h3>
                    <div id="activity-list" class="activity-list">
                        <!-- Activity will be populated here -->
                    </div>
                </div>
                <div class="latency-indicator">
                    <span>Latency: </span>
                    <span id="latency-value">â€”</span>
                </div>
            </main>
            <div class="ptt-container">
                <div id="speaking-indicator" class="speaking-indicator">
                    <svg class="icon">
                        <use href="#icon-waveform"></use>
                    </svg>
                    <span>Not speaking</span>
                </div>
                <button id="ptt-btn" class="ptt-button" disabled>
                    <svg class="icon">
                        <use href="#icon-mic"></use>
                    </svg>
                    <span>Hold to Speak</span>
                </button>
                <div class="ptt-hint">
                    <span>Press Spacebar or tap to speak</span>
                </div>
            </div>
        </div>

        <!-- Settings/Admin Page -->
        <div id="settings-page" class="page">
            <header class="app-header">
                <button id="settings-back-btn" class="icon-btn" aria-label="Back">
                    <svg class="icon" style="transform: rotate(180deg);">
                        <use href="#icon-chevron-right"></use>
                    </svg>
                </button>
                <h1>Settings</h1>
            </header>
            <main class="page-content">
                <div class="settings-section">
                    <h3>Audio</h3>
                    <div class="setting-item">
                        <label>
                            <span>Microphone</span>
                            <select id="mic-select">
                                <option value="default">Default</option>
                            </select>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <span>Speaker</span>
                            <select id="speaker-select">
                                <option value="default">Default</option>
                            </select>
                        </label>
                    </div>
                </div>
                <div class="settings-section" id="admin-section" style="display: none;">
                    <h3>Admin Controls</h3>
                    <button id="emergency-btn" class="btn btn-danger">
                        <svg class="icon">
                            <use href="#icon-alert"></use>
                        </svg>
                        <span>Emergency Broadcast</span>
                    </button>
                </div>
                <div class="settings-section">
                    <button id="logout-btn" class="btn btn-secondary">
                        <span>Logout</span>
                    </button>
                </div>
            </main>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container"></div>

    <!-- Scripts -->
    <script src="firebase-config.js"></script>
    <script src="app.js"></script>
</body>

</html>